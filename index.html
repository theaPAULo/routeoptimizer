<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="font-src 'self' fonts.gstatic.com *.gstatic.com data:;">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Route Optimizer</title>
    <!-- Add Tailwind CSS via CDN for quick styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Add Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
    <!-- Define the callback function before loading the Maps API -->
    <script>
        // This function will be called by the Google Maps API when it loads
        function initMap() {
            console.log("Google Maps API loaded successfully");
            // Initialize our application
            initializeApp();
        }
        
        // Global variables
        let map;
        let directionsService;
        let directionsRenderer;
        let geocoder;
        let autocompletes = [];
        let currentRoute = null;
        let stopCounter = 0;

        /**
         * Main initialization function - called after Google Maps loads
         */
        function initializeApp() {
            console.log("Initializing Route Optimizer App");
            
            // DOM Elements
            const routeForm = document.getElementById('route-form');
            const stopsContainer = document.getElementById('stops-container');
            const addStopBtn = document.getElementById('add-stop-btn');
            const optimizeBtn = document.getElementById('optimize-btn');
            const backBtn = document.getElementById('back-btn');
            const saveBtn = document.getElementById('save-btn');
            const loadingSpinner = document.getElementById('loading-spinner');
            const optimizeBtnText = document.getElementById('optimize-btn-text');
            const inputSection = document.getElementById('input-section');
            const resultsSection = document.getElementById('results-section');
            const alertBox = document.getElementById('alert-box');
            const totalDistance = document.getElementById('total-distance');
            const estimatedTime = document.getElementById('estimated-time');
            const routeList = document.getElementById('route-list');
            const mapContainer = document.getElementById('map-container');
            
            // Set up Google Maps components
            initializeGoogleMaps();
            
            // Add first stop input
            addStopInput();
            
            // Set up event listeners
            addStopBtn.addEventListener('click', addStopInput);
            routeForm.addEventListener('submit', handleFormSubmit);
            backBtn.addEventListener('click', showInputSection);
            saveBtn.addEventListener('click', saveRoute);
        }

        /**
         * Initialize Google Maps components
         */
        function initializeGoogleMaps() {
            console.log("Setting up Google Maps components");
            
            try {
                // Create directions service for route calculation
                directionsService = new google.maps.DirectionsService();
                
                // Create geocoder for converting addresses to coordinates
                geocoder = new google.maps.Geocoder();
                
                // Initialize map
                const mapContainer = document.getElementById('map-container');
                if (mapContainer) {
                    console.log("Initializing map in container:", mapContainer);
                    
                    // Force a height if not set in CSS
                    if (mapContainer.offsetHeight === 0) {
                        mapContainer.style.height = '400px';
                    }
                    
                    // Initialize the map
                    map = new google.maps.Map(mapContainer, {
                        center: { lat: 40.7128, lng: -74.0060 }, // Default to NYC
                        zoom: 12,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    });
                    
                    // Create directions renderer for displaying routes
                    directionsRenderer = new google.maps.DirectionsRenderer({
                        map: map,
                        suppressMarkers: false,
                        draggable: false,
                        polylineOptions: {
                            strokeColor: '#3b82f6',
                            strokeWeight: 5,
                            strokeOpacity: 0.7
                        }
                    });
                    
                    console.log("Map initialized successfully");
                } else {
                    console.error("Map container not found");
                }
                
                // Setup autocomplete for start/end fields
                setupAutocomplete('start-location');
                setupAutocomplete('end-location');
                
            } catch (error) {
                console.error("Error setting up Google Maps components:", error);
            }
        }

        /**
         * Sets up autocomplete for an input field
         * @param {string} inputId - ID of the input field
         */
        function setupAutocomplete(inputId) {
            const input = document.getElementById(inputId);
            if (!input) {
                console.error(`Input element with ID ${inputId} not found`);
                return;
            }
            
            try {
                const autocomplete = new google.maps.places.Autocomplete(input, {
                    types: ['address']
                });
                console.log(`Autocomplete initialized for ${inputId}`);
                
                // Store autocomplete instance
                autocompletes.push({ id: inputId, instance: autocomplete });
            } catch (error) {
                console.error(`Error setting up autocomplete for ${inputId}:`, error);
            }
        }

        /**
         * Adds a new stop input field to the form with Google Places autocomplete
         */
        function addStopInput() {
            stopCounter++;
            const stopId = `stop-${stopCounter}`;
            
            const stopDiv = document.createElement('div');
            stopDiv.className = 'stop-item fade-in';
            stopDiv.innerHTML = `
                <div class="relative flex items-center mb-2">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                        <i class="fas fa-map-pin text-gray-400"></i>
                    </span>
                    <input 
                        type="text" 
                        id="${stopId}" 
                        class="block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                        placeholder="Enter stop address"
                        required
                    >
                    ${stopCounter > 1 ? `<button 
                        type="button" 
                        class="absolute right-2 text-red-500 hover:text-red-700"
                        aria-label="Remove stop"
                        onclick="removeStop(this)"
                    >
                        <i class="fas fa-times"></i>
                    </button>` : ''}
                </div>
            `;
            
            const stopsContainer = document.getElementById('stops-container');
            stopsContainer.appendChild(stopDiv);
            
            // Add Google Places autocomplete
            setupAutocomplete(stopId);
        }

        /**
         * Removes a stop input field
         * @param {HTMLElement} button - The remove button that was clicked
         */
        function removeStop(button) {
            const stopItem = button.closest('.stop-item');
            const inputId = stopItem.querySelector('input').id;
            
            // Remove autocomplete from tracking array
            autocompletes = autocompletes.filter(item => item.id !== inputId);
            
            // Animate removal
            stopItem.style.opacity = 0;
            setTimeout(() => {
                const stopsContainer = document.getElementById('stops-container');
                stopsContainer.removeChild(stopItem);
            }, 300);
        }

        /**
         * Shows an alert message to the user
         * @param {string} message - The message to display
         * @param {string} type - The type of alert (error, success, info)
         */
        function showAlert(message, type = 'error') {
            const alertBox = document.getElementById('alert-box');
            alertBox.textContent = message;
            alertBox.className = `${type} mb-4 p-4 rounded-md fade-in`;
            alertBox.classList.remove('hidden');
            
            // Automatically hide after 5 seconds
            setTimeout(() => {
                alertBox.classList.add('hidden');
            }, 5000);
        }

        /**
         * Handles the form submission
         * @param {Event} event - The form submission event
         */
        async function handleFormSubmit(event) {
            event.preventDefault();
            
            // Collect form data
            const startLocation = document.getElementById('start-location').value;
            const endLocation = document.getElementById('end-location').value;
            
            // Collect all stops
            const stops = [];
            const stopInputs = document.getElementById('stops-container').querySelectorAll('input[type="text"]');
            
            for (const input of stopInputs) {
                if (input.value.trim()) {
                    stops.push(input.value.trim());
                }
            }
            
            // Basic validation
            if (!startLocation) {
                showAlert('Please enter a starting location');
                return;
            }
            
            if (!endLocation) {
                showAlert('Please enter an ending location');
                return;
            }
            
            if (stops.length === 0) {
                showAlert('Please add at least one stop');
                return;
            }
            
            // Show loading state
            toggleLoadingState(true);
            
            try {
                console.log("Calculating route with:", {
                    start: startLocation,
                    stops: stops,
                    end: endLocation
                });
                
                // Step 1: Validate and geocode all addresses
                const locations = await validateAddresses({
                    start: startLocation,
                    end: endLocation,
                    stops: stops
                });
                
                console.log("Geocoded locations:", locations);
                
                // Step 2: Calculate the optimized route
                const routeResult = await calculateOptimizedRoute(locations);
                
                console.log("Route calculation result:", routeResult);
                
                // Update UI with results
                displayRouteResults(routeResult);
            } catch (error) {
                console.error("Route calculation error:", error);
                showAlert(error.message || 'Error calculating route. Please try again.');
                toggleLoadingState(false);
            }
        }

        /**
         * Validates all addresses using Google Geocoding API
         * @param {Object} locations - Object containing start, end, and stops addresses
         * @returns {Promise} - Promise resolving to validated locations with coordinates
         */
        async function validateAddresses(locations) {
            try {
                console.log("Validating addresses:", locations);
                
                // Create geocoding promises for all addresses
                const startPromise = geocodeAddress(locations.start);
                const endPromise = geocodeAddress(locations.end);
                const stopsPromises = locations.stops.map(stop => geocodeAddress(stop));
                
                // Wait for all geocoding requests to complete
                const [startResult, endResult, ...stopsResults] = await Promise.all([
                    startPromise, 
                    endPromise, 
                    ...stopsPromises
                ]);
                
                console.log("Geocoding results:", {
                    start: startResult,
                    end: endResult,
                    stops: stopsResults
                });
                
                // Check if any geocoding failed
                if (!startResult || !endResult || stopsResults.includes(null)) {
                    throw new Error('One or more addresses could not be found. Please check your inputs.');
                }
                
                return {
                    start: startResult,
                    end: endResult,
                    stops: stopsResults
                };
            } catch (error) {
                console.error('Address validation error:', error);
                throw error;
            }
        }

        /**
         * Geocodes an address to coordinates
         * @param {string} address - The address to geocode
         * @returns {Promise} - Promise resolving to location object with coordinates
         */
        function geocodeAddress(address) {
            return new Promise((resolve, reject) => {
                console.log("Geocoding address:", address);
                
                geocoder.geocode({ address }, (results, status) => {
                    console.log(`Geocoding result for "${address}":`, status, results);
                    
                    if (status === 'OK' && results && results.length > 0) {
                        resolve({
                            address: results[0].formatted_address,
                            location: results[0].geometry.location,
                            placeId: results[0].place_id
                        });
                    } else {
                        console.error('Geocoding failed for address:', address, status);
                        resolve(null); // Resolve with null to handle in the main validation function
                    }
                });
            });
        }

        /**
         * Calculates an optimized route using Google Directions Service
         * @param {Object} locations - Object containing geocoded addresses
         * @returns {Promise} - Promise resolving to route data
         */
        function calculateOptimizedRoute(locations) {
            return new Promise((resolve, reject) => {
                console.log("Calculating optimized route...");
                
                // For the Google Directions API, we need to optimize waypoint order
                const waypoints = locations.stops.map(stop => ({
                    location: stop.location,
                    stopover: true
                }));
                
                const request = {
                    origin: locations.start.location,
                    destination: locations.end.location,
                    waypoints: waypoints,
                    optimizeWaypoints: true, // This is key for route optimization
                    travelMode: google.maps.TravelMode.DRIVING
                };
                
                console.log("Direction request:", request);
                
                directionsService.route(request, (result, status) => {
                    console.log("Directions service response:", status, result);
                    
                    if (status === 'OK') {
                        // Process route data
                        const legs = result.routes[0].legs;
                        const waypointOrder = result.routes[0].waypoint_order;
                        
                        // Calculate total distance and time
                        let totalDistanceMeters = 0;
                        let totalDurationSeconds = 0;
                        
                        for (const leg of legs) {
                            totalDistanceMeters += leg.distance.value;
                            totalDurationSeconds += leg.duration.value;
                        }
                        
                        // Convert to miles and minutes
                        const totalDistanceMiles = (totalDistanceMeters / 1609.34).toFixed(1);
                        const totalDurationMinutes = Math.round(totalDurationSeconds / 60);
                        
                        // Format duration into hours and minutes
                        let durationText;
                        if (totalDurationMinutes >= 60) {
                            const hours = Math.floor(totalDurationMinutes / 60);
                            const minutes = totalDurationMinutes % 60;
                            durationText = `${hours} hr ${minutes} min`;
                        } else {
                            durationText = `${totalDurationMinutes} min`;
                        }
                        
                        // Create ordered waypoints list based on the optimization
                        const orderedWaypoints = [
                            { address: locations.start.address, type: 'start' }
                        ];
                        
                        // Add stops in optimized order
                        for (const index of waypointOrder) {
                            orderedWaypoints.push({
                                address: locations.stops[index].address,
                                type: 'stop'
                            });
                        }
                        
                        // Add destination
                        orderedWaypoints.push({
                            address: locations.end.address,
                            type: 'end'
                        });
                        
                        // Create route object
                        const route = {
                            totalDistance: `${totalDistanceMiles} miles`,
                            estimatedTime: durationText,
                            waypoints: orderedWaypoints,
                            directionsResult: result
                        };
                        
                        resolve(route);
                    } else {
                        console.error('Directions request failed:', status);
                        reject(new Error('Could not calculate route. Please try different locations.'));
                    }
                });
            });
        }

        /**
         * Toggles the loading state of the form
         * @param {boolean} isLoading - Whether the form is in loading state
         */
        function toggleLoadingState(isLoading) {
            const optimizeBtn = document.getElementById('optimize-btn');
            const optimizeBtnText = document.getElementById('optimize-btn-text');
            const loadingSpinner = document.getElementById('loading-spinner');
            
            if (isLoading) {
                optimizeBtnText.textContent = 'Calculating optimal route...';
                loadingSpinner.classList.remove('hidden');
                optimizeBtn.disabled = true;
            } else {
                optimizeBtnText.textContent = 'Optimize Route';
                loadingSpinner.classList.add('hidden');
                optimizeBtn.disabled = false;
            }
        }

        /**
         * Displays the route results in the UI and on the map
         * @param {Object} route - The optimized route data
         */
        function displayRouteResults(route) {
            console.log("Displaying route results:", route);
            
            // Store current route
            currentRoute = route;
            
            // End loading state
            toggleLoadingState(false);
            
            // Update stats
            const totalDistance = document.getElementById('total-distance');
            const estimatedTime = document.getElementById('estimated-time');
            totalDistance.textContent = route.totalDistance;
            estimatedTime.textContent = route.estimatedTime;
            
            // Display route on map
            directionsRenderer.setDirections(route.directionsResult);
            
            // Clear previous route list
            const routeList = document.getElementById('route-list');
            routeList.innerHTML = '';
            
            // Add route points to list
            route.waypoints.forEach((point, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'slide-down';
                listItem.style.animationDelay = `${index * 0.1}s`;
                
                listItem.innerHTML = `
                    <div class="stop-number">${index + 1}</div>
                    <div class="stop-address">${point.address}</div>
                    <div class="stop-type ${point.type}">${point.type}</div>
                `;
                
                routeList.appendChild(listItem);
            });
            
            // Show results section
            const inputSection = document.getElementById('input-section');
            const resultsSection = document.getElementById('results-section');
            inputSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            resultsSection.classList.add('fade-in');
            
            // Trigger a resize event to ensure map displays correctly
            setTimeout(() => {
                google.maps.event.trigger(map, 'resize');
                
                // Set map bounds to fit the route
                const bounds = new google.maps.LatLngBounds();
                route.directionsResult.routes[0].legs.forEach(leg => {
                    bounds.extend(leg.start_location);
                    bounds.extend(leg.end_location);
                });
                map.fitBounds(bounds);
            }, 100);
        }

        /**
         * Shows the input section again
         */
        function showInputSection() {
            const inputSection = document.getElementById('input-section');
            const resultsSection = document.getElementById('results-section');
            inputSection.classList.remove('hidden');
            resultsSection.classList.add('hidden');
        }

        /**
         * Saves the current route (localStorage implementation)
         */
        function saveRoute() {
            if (!currentRoute) return;
            
            // Create a route object to save
            const routeToSave = {
                id: Date.now(),
                name: `Route ${new Date().toLocaleDateString()}`,
                totalDistance: currentRoute.totalDistance,
                estimatedTime: currentRoute.estimatedTime,
                waypoints: currentRoute.waypoints,
                date: new Date().toISOString()
            };
            
            // Get existing saved routes or initialize empty array
            const savedRoutes = JSON.parse(localStorage.getItem('savedRoutes') || '[]');
            
            // Add new route
            savedRoutes.push(routeToSave);
            
            // Save back to localStorage
            localStorage.setItem('savedRoutes', JSON.stringify(savedRoutes));
            
            showAlert('Route saved successfully!', 'success');
        }
    </script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto p-4">
        <header class="mb-8">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-blue-700">Route Optimizer</h1>
                <div>
                    <a href="https://github.com/yourusername/route-optimizer" target="_blank" 
                       class="text-gray-600 hover:text-black" title="View on GitHub">
                        <i class="fab fa-github text-2xl"></i>
                    </a>
                </div>
            </div>
            <p class="text-gray-600 mt-2">Find the most efficient route for multiple stops</p>
        </header>

        <main>
            <!-- Alert Box for Errors and Messages -->
            <div id="alert-box" class="hidden mb-4 p-4 rounded-md"></div>

            <!-- Input Form Section -->
            <section id="input-section" class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">Enter Your Locations</h2>
                
                <form id="route-form" class="space-y-4">
                    <!-- Starting Location -->
                    <div>
                        <label for="start-location" class="block text-sm font-medium text-gray-700 mb-1">
                            Starting Location
                        </label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                <i class="fas fa-map-marker-alt text-gray-400"></i>
                            </span>
                            <input 
                                type="text" 
                                id="start-location" 
                                class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                placeholder="Enter starting address"
                                required
                            >
                        </div>
                    </div>

                    <!-- Stops Container -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">
                            Stops
                        </label>
                        <div id="stops-container">
                            <!-- Initial stop field will be added by JavaScript -->
                        </div>
                        <button 
                            type="button" 
                            id="add-stop-btn" 
                            class="mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center"
                        >
                            <i class="fas fa-plus-circle mr-1"></i> Add another stop
                        </button>
                    </div>

                    <!-- Ending Location -->
                    <div>
                        <label for="end-location" class="block text-sm font-medium text-gray-700 mb-1">
                            Ending Location
                        </label>
                        <div class="relative">
                            <span class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                <i class="fas fa-flag-checkered text-gray-400"></i>
                            </span>
                            <input 
                                type="text" 
                                id="end-location" 
                                class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                                placeholder="Enter ending address"
                                required
                            >
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-2">
                        <button 
                            type="submit" 
                            id="optimize-btn"
                            class="w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                        >
                            <span id="optimize-btn-text">Optimize Route</span>
                            <span id="loading-spinner" class="hidden">
                                <i class="fas fa-spinner fa-spin ml-2"></i>
                            </span>
                        </button>
                    </div>
                </form>
            </section>

            <!-- Results Section (Hidden by default) -->
            <section id="results-section" class="bg-white rounded-lg shadow-md p-6 hidden">
                <h2 class="text-xl font-semibold mb-4">Optimized Route</h2>
                
                <div class="grid md:grid-cols-2 gap-4 mb-6">
                    <div class="bg-blue-50 p-4 rounded-md">
                        <div class="flex items-center">
                            <i class="fas fa-route text-blue-600 text-xl mr-3"></i>
                            <div>
                                <h3 class="text-gray-500 text-sm">Total Distance</h3>
                                <p id="total-distance" class="font-medium text-lg">0 miles</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-md">
                        <div class="flex items-center">
                            <i class="fas fa-clock text-blue-600 text-xl mr-3"></i>
                            <div>
                                <h3 class="text-gray-500 text-sm">Estimated Time</h3>
                                <p id="estimated-time" class="font-medium text-lg">0 min</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Map Container -->
                <div id="map-container" class="w-full h-64 md:h-96 rounded-md mb-6 border border-gray-300 overflow-hidden">
                    <!-- Google Map will be rendered here -->
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-3">Recommended Route Order:</h3>
                    <ol id="route-list" class="space-y-2 pl-0">
                        <!-- Route points will be added by JavaScript -->
                    </ol>
                </div>
                
                <div class="flex justify-between">
                    <button 
                        id="back-btn"
                        class="py-2 px-4 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                    >
                        Back to Form
                    </button>
                    <button 
                        id="save-btn"
                        class="py-2 px-4 bg-green-600 hover:bg-green-700 text-white font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors"
                    >
                        <i class="fas fa-save mr-1"></i> Save Route
                    </button>
                </div>
            </section>
        </main>

        <footer class="mt-8 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Route Optimizer | <a href="#" class="text-blue-600 hover:underline">Privacy Policy</a></p>
        </footer>
    </div>

    <!-- Load the Google Maps API -->
    <script async defer 
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCancy_vwbDbYZavxDjtpL7NW4lYl8Tkmk&libraries=places&callback=initMap">
    </script>

    <script>
// Function to enhance existing inputs with business search
function enhanceExistingInputs() {
  // Wait for Google API to be ready
  if (!window.google || !window.google.maps || !window.google.maps.places) {
    console.log('Waiting for Google Places API...');
    setTimeout(enhanceExistingInputs, 500);
    return;
  }
  
  console.log('Enhancing inputs with business search capability');
  
  // Target all location inputs
  const inputs = [
    document.getElementById('start-location'),
    document.getElementById('end-location'),
    ...Array.from(document.querySelectorAll('#stops-container input[type="text"]'))
  ].filter(el => el); // Remove any null values
  
  // Replace existing autocomplete instances with new ones
  inputs.forEach(input => {
    // Create a new autocomplete instance with minimal options
    const autocomplete = new google.maps.places.Autocomplete(input);
    console.log(`Enhanced ${input.id || 'unnamed input'} with business search`);
    
    // Add a place_changed listener for debugging
    autocomplete.addListener('place_changed', function() {
      const place = autocomplete.getPlace();
      console.log(`Place selected for ${input.id}:`, place);
    });
  });
  
  // Monitor for new stop inputs
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.addedNodes.length) {
        const newInputs = Array.from(mutation.addedNodes)
          .filter(node => node.nodeType === 1) // Only element nodes
          .flatMap(node => {
            // Check if the node itself is an input
            if (node.tagName === 'INPUT' && node.type === 'text') {
              return [node];
            }
            // Or if it contains inputs
            return Array.from(node.querySelectorAll('input[type="text"]'));
          });
        
        if (newInputs.length) {
          newInputs.forEach(input => {
            const autocomplete = new google.maps.places.Autocomplete(input);
            console.log(`Enhanced new input with business search`);
          });
        }
      }
    });
  });
  
  // Start observing the stops container
  observer.observe(document.getElementById('stops-container'), { 
    childList: true, 
    subtree: true 
  });
  
  console.log('Business search enhancement complete');
}

// Run the enhancement after a short delay to ensure everything is loaded
setTimeout(enhanceExistingInputs, 1000);
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(enhanceExistingInputs, 1000);
  });
  </script>
  <!-- Core application script -->
  <script src="app.js"></script>
  <!-- Google Places API integration (just one implementation) -->
  <script src="places-integration.js"></script>
</body>
</html>
